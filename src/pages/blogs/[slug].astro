---
import BaseLayout from '../../layouts/BaseLayout.astro';
import DateDisplay from '../../components/DateDisplay.astro';
import { loadPosts, loadPostBySlug, type Post } from '../../components/posts';
import { marked } from 'marked';

export async function getStaticPaths() {
  const posts = loadPosts();

  return posts.map((post) => ({
    params: { slug: post.slug },
  }));
}

const { slug } = Astro.params;
const post: Post = loadPostBySlug(slug);
---

<BaseLayout title={post.title}>
  <article class="px-6 py-8 md:px-16 max-w-3xl mx-auto">
    <h1 class="text-2xl font-bold mb-2">{post.title}</h1>
    <p class="text-sm text-gray-600 mb-6">
      Veröffentlicht am <DateDisplay date={post.date} />
    </p>

    {post.image && (
      <a href={post.image} target="_blank" class="block w-full h-[250px] overflow-hidden mb-8">
        <img
          src={post.image}
          alt={`Beitragsbild: ${post.title}`}
          class="w-full h-full object-cover object-center block"
        />
      </a>
    )}

    <section class="prose prose-sm sm:prose lg:prose-lg prose-img:rounded" 
         set:html={marked(post.content)}>
</section>
</section> <!-- Markdown wird hier gerendert -->
    </section>

    <h3 class="mt-10">
      <a href="/blogauto" class="text-gray-800 underline hover:text-black">
        Zurück zur Blogübersicht
      </a>
    </h3>
  </article>
</BaseLayout>
