---
import { loadPosts } from "../../components/posts";
import BaseLayout from "../../layouts/BaseLayout.astro";
import DateDisplay from "../../components/DateDisplay.astro";

export async function getStaticPaths() {
  const posts = loadPosts();

  // alle Collections herausziehen
  const collections = Array.from(
    new Set(posts.map((post) => post.collection).filter(Boolean))
  );

  return collections.map((slug) => ({
    params: { slug },
    props: {
      slug,
      posts: posts.filter((post) => post.collection === slug),
    },
  }));
}

const { slug, posts } = Astro.props;
---

<BaseLayout title={`Sammlung: ${slug}`}>
  <main class="px-6 py-10 max-w-3xl mx-auto">
    <h1 class="text-2xl font-bold mb-6">Sammlung: {slug}</h1>

    <ul style="list-style: none; padding: 0;">
      {posts.map((post) => (
        <li style="margin-bottom: 2rem;">
          <a
            href={`../blogs/${post.slug}`}
            style="text-decoration: none; color: inherit;"
          >
            <h2 class="text-xl font-semibold">{post.title}</h2>
            <p class="text-gray-600">{post.description}</p>
            <small class="text-gray-500">
              <DateDisplay date={post.date} />
            </small>
          </a>
        </li>
      ))}
    </ul>
  </main>
</BaseLayout>
